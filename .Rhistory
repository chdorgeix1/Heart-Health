for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.toLowerCase().includes(\"proportion heart attacks\")) {
legends[i].style.display = 'block';
}
}
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 100);
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Show the legend for the initially active layer (if any)
function showInitialLegend() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.toLowerCase().includes(\"proportion heart attacks\")) {
legends[i].style.display = 'block';
}
}
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 1000);
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Show the legend for the initially active layer (if any)
function showInitialLegend() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
}
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 1000);
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Show the legend for the initially active layer (if any)
function showInitialLegend() {
var activeLayers = [];
map.eachLayer(function(layer) {
if (layer.options && layer.options.pane === 'overlayPane' && map.hasLayer(layer)) {
activeLayers.push(layer.options.group);
}
});
if (activeLayers.length > 0) {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(activeLayers[0])) {
legends[i].style.display = 'block';
break;
}
}
}
}
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 100);
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Show the legend for the initially active layer (if any)
function showInitialLegend() {
var activeLayers = [];
map.eachLayer(function(layer) {
if (layer.options && layer.options.pane === 'overlayPane' && map.hasLayer(layer)) {
activeLayers.push(layer.options.group);
}
});
if (activeLayers.length > 0) {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(activeLayers[0])) {
legends[i].style.display = 'block';
break;
}
}
}
}
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
setTimeout(100);
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 100);
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Show the legend for the initially active layer (if any)
function showInitialLegend() {
var activeLayers = [];
map.eachLayer(function(layer) {
if (layer.options && layer.options.pane === 'overlayPane' && map.hasLayer(layer)) {
activeLayers.push(layer.options.group);
}
});
if (activeLayers.length > 0) {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(activeLayers[0])) {
legends[i].style.display = 'block';
break;
}
}
}
}
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
setTimeout(100000);
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
// Call after a short delay to ensure all elements are loaded
setTimeout(showInitialLegend, 100);
}
")
leaflet_map
leaflet_map <- tmap_leaflet(map)
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
function showInitialLegend() {
var activeLayers = [];
map.eachLayer(function(layer) {
if (layer.options && layer.options.group && map.hasLayer(layer)) {
activeLayers.push(layer.options.group);
}
});
if (activeLayers.length > 0) {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(activeLayers[0])) {
legends[i].style.display = 'block';
break;
}
}
} else {
}
}
showInitialLegend();
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
map <- tm_shape(us_states) +
tm_polygons(fill = "ProportionHeartAttacks",
group = "Proportion Heart Attacks",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "reds"),
fill.legend = tm_legend(title = "Proportion Heart Attacks",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_shape(us_states) +
tm_polygons(fill = "AverageAge",
group = "Average Age",
group.control = 'radio',
fill.scale = tm_scale_continuous(values = "greens"),
fill.legend = tm_legend(title = "Average Age",
orientation = "landscape",
position = tm_pos_out("center", "bottom"),
frame = FALSE)) +
tm_basemap('OpenStreetMap', group.control = 'none')
leaflet_map <- tmap_leaflet(map)
leaflet_map <- leaflet_map %>%
onRender("
function(el, x) {
var map = this;
// Function to hide all legends
function hideAllLegends() {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
legends[i].style.display = 'none';
}
}
// Hide all legends when the map loads
hideAllLegends();
function showInitialLegend() {
var activeLayers = [];
map.eachLayer(function(layer) {
if (layer.options && layer.options.group && map.hasLayer(layer)) {
activeLayers.push(layer.options.group);
}
});
if (activeLayers.length > 0) {
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(activeLayers[0])) {
legends[i].style.display = 'block';
break;
}
}
} else {
}
}
showInitialLegend();
// Update legends when layer changes
map.on('baselayerchange', function (e) {
hideAllLegends();
var legends = document.getElementsByClassName('info legend leaflet-control');
for (var i = 0; i < legends.length; i++) {
if (legends[i].innerHTML.includes(e.name)) {
legends[i].style.display = 'block';
}
}
});
}
")
leaflet_map
#tmap_save(leaflet_map, "./generated_maps/interactive_US_map.html")
saveWidget(leaflet_map, "./generated_maps/interactive_US_map_3.html")
